var strPoints=sessionStorage.getItem("strPoints")||"pointsShop",strCate=sessionStorage.getItem("strCate")||"all",isSearching=sessionStorage.getItem("isSearching"),isTranSearching=sessionStorage.getItem("isTranSearching"),isMG=sessionStorage.getItem("isManager"),isUser=sessionStorage.getItem("userLogin");$(function(){function e(){var n=$("main").find("div, p, h1, h2, h3, h4, h5, h6").not(".expired-overlay"),i=Math.floor(Math.random()*n.length),r=Math.ceil(Math.random()*4);n.eq(i).hasClass("position-relative")?sessionStorage.setItem("oriPosRel","true"):n.eq(i).addClass("position-relative");n.eq(i).append(`<img id="gameLogo" class="position-absolute p-0" style="width: 30px; height: 30px; z-index: -1;" src=${u} />`);$("#gameLogo").css("animation-name",`gameLogoShow${r}`);$("#gameLogo").on("click",function(){fetch(f,{method:"GET"}).then(n=>n.json()).then(n=>{var r=new bootstrap.Toast($("#liveToast")),i;n=="今日已完成小遊戲"?($("#liveToast>.toast-header").html(`<strong class="me-auto">今日完成次數達上限!</strong><button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>`),$("#liveToast>.toast-body").text(`今日完成小遊戲次數已達上限`)):($("#liveToast>.toast-header").html(`<strong class="me-auto">恭喜找到小Q!</strong><button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>`),$("#liveToast>.toast-body").text(`恭喜獲得${n[0]}點
現在點數:${n[1]}
今日已完成小遊戲次數:(${n[2]}/3)`),n[2]==3&&(i=`${$("#home").data("uri")}`,fetch(i,{method:"GET"}).then(()=>{}).catch(n=>{alert(n)})));r.show();$(this).hide();clearInterval(t)}).catch(n=>{alert(n)})});setTimeout(function(){sessionStorage.getItem("oriPosRel")=="true"?sessionStorage.removeItem("oriPosRel"):$("main").find("#gameLogo").parent().removeClass("position-relative");$("main").find("#gameLogo").remove()},4e3)}var n,i,r,u,f,t;$("#pointsNav, #pointsDropdown").on("mouseenter",function(){clearTimeout(n);$("#pointsNav").addClass("show");$("#pointsNav").attr("aria-expanded","true");$("#pointsDropdown").addClass("show");$("#pointsDropdown").attr("data-bs-popper","none")});$("#pointsNav, #pointsDropdown").on("mouseleave",function(){n=setTimeout(function(){$("#pointsNav").removeClass("show");$("#pointsNav").attr("aria-expanded","false");$("#pointsDropdown").removeClass("show");$("#pointsDropdown").attr("data-bs-popper","")},100)});$("#pointsShop").on("click",function(){strPoints="pointsShop";sessionStorage.setItem("strPoints",strPoints)});$("#pointsHistory").on("click",function(){strPoints="pointsHistory";sessionStorage.setItem("strPoints",strPoints)});$("#coupon").on("click",function(){strPoints="coupon";sessionStorage.setItem("strPoints",strPoints)});i=$("#isLogin").find("span");i.length!=0?($("#OrganizersLoginRegisterNav").hide(),sessionStorage.setItem("userLogin","true")):($("#OrganizersLoginRegisterNav").show(),sessionStorage.removeItem("userLogin"));r=$("#mainModal").data("url");$.ajax({type:"GET",url:r}).done(function(n){$("#mainModalBody").html(n)}).fail(function(n){alert(n.responseText)});$("#home").on("mousedown",function(){setTimeout(function(){$("#logo").css("animation-name","logoSpin")},1e3);n=setTimeout(function(){if($("#logo").css("animation-name",""),isMG=="true"){var n=$("#logo").data("url"),t=new FormData;sessionStorage.removeItem("isManager");$("#mainModalBody").html('<div class="d-flex justify-content-center"><h2 class="m-auto text-gradient">恭喜下班，肝苦人<\/h2><\/div>');$("#mainModal").modal("show");fetch(`${n}`,{method:"POST",body:t}).then(function(n){console.log(n)}).catch(function(n){alert(n)});setTimeout(function(){location.reload()},1e3)}else $("#mainModal").modal("show")},3e3)});$("#home").on("mousedup",function(){$("#logo").css("animation-name","");clearTimeout(n)});$("#checkIn").on("click",function(){var n=`${$(this).data("uri")}`;fetch(n,{method:"GET"}).then(n=>n.json()).then(n=>{var i=new bootstrap.Toast($("#liveToast")),t;n=="今日已簽到"?($("#liveToast>.toast-header").html(`<strong class="me-auto">今日已簽到!</strong><button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>`),$("#liveToast>.toast-body").text(`今日已簽到完成`)):($("#liveToast>.toast-header").html(`<strong class="me-auto">每日簽到完成!</strong><button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>`),$("#liveToast>.toast-body").text(`恭喜獲得${n[0]}點
現在點數:${n[1]}`),t=`${$("#home").data("uri")}`,fetch(t,{method:"GET"}).then(()=>{}).catch(n=>{alert(n)}));i.show();$(this).hide()}).catch(n=>{alert(n)})});u=$("#game").data("src");f=$("#game").data("uri");$("#game").index()!=-1&&$(".spinBtn").index()==-1?t=setInterval(function(){e()},4100):clearInterval(t)});