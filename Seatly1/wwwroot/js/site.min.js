var strPoints=sessionStorage.getItem("strPoints")||"pointsShop",strCate=sessionStorage.getItem("strCate")||"all",isSearching=sessionStorage.getItem("isSearching"),isTranSearching=sessionStorage.getItem("isTranSearching"),isMG=null,isUser=sessionStorage.getItem("userLogin"),mouseX=0,mouseY=0;window.addEventListener("mousemove",n=>{mouseX=n.clientX,mouseY=n.clientY});const insertLoading=()=>{var n={x:mouseX,y:mouseY};document.querySelector("body").insertAdjacentHTML("beforeend",`<div id="saveLoading" class="position-fixed" style="top: ${n.y}px; left: ${n.x}px;"><div role="img" class="wheel-and-queuely"><div class="wheel"></div><img src="${window.location.origin}/images/queuelyhome.png" class="queuely" /><div class="spoke"></div></div></div>`)},followingLoading=n=>{var i={x:n.clientX,y:n.clientY};const t=document.querySelector("#saveLoading");t&&(t.style.top=`${i.y}px`,t.style.left=`${i.x}px`)},removeMouseMoveListener=()=>{window.removeEventListener("mousemove",followingLoading)},saveLoading=()=>{insertLoading(),window.addEventListener("mousemove",followingLoading)},removeSaveLoading=()=>{removeMouseMoveListener();const n=document.querySelector("#saveLoading");n&&n.remove()},MGCheck=()=>{const n=`${window.location.origin}/Home/CheckIsMG`;fetch(n,{method:"GET"}).then(n=>n.text()).then(n=>{n!=="false"&&sessionStorage.setItem("isManager","true")}).catch(n=>console.error("Error fetching MG status:",n.message));return sessionStorage.getItem("isManager")};isMG=MGCheck();$(function(){function f(){var n=$("main").find("div, p, h1, h2, h3, h4, h5, h6").not(".expired-overlay"),i=Math.floor(Math.random()*n.length),f=Math.ceil(Math.random()*4);n.eq(i).hasClass("position-relative")?sessionStorage.setItem("oriPosRel","true"):n.eq(i).addClass("position-relative");n.eq(i).append(`<img id="gameLogo" class="position-absolute p-0" style="width: 30px; height: 30px; z-index: -1;" src=${r} />`);$("#gameLogo").css("animation-name",`gameLogoShow${f}`);$("#gameLogo").on("click",function(){fetch(u,{method:"GET"}).then(n=>n.json()).then(n=>{var r=new bootstrap.Toast($("#liveToast")),i;n=="今日已完成小遊戲"?($("#liveToast>.toast-header").html(`<strong class="me-auto">今日完成次數達上限!</strong><button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>`),$("#liveToast>.toast-body").text(`今日完成小遊戲次數已達上限`)):($("#liveToast>.toast-header").html(`<strong class="me-auto">恭喜找到小Q!</strong><button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>`),$("#liveToast>.toast-body").text(`恭喜獲得${n[0]}點
現在點數:${n[1]}
今日已完成小遊戲次數:(${n[2]}/3)`),n[2]==3&&(i=`${$("#home").data("uri")}`,fetch(i,{method:"GET"}).then(()=>{sessionStorage.setItem("userPointsEdited","true")}).catch(n=>{alert(n)})));r.show();$(this).hide();clearInterval(t)}).catch(n=>{alert(n)})});setTimeout(function(){sessionStorage.getItem("oriPosRel")=="true"?sessionStorage.removeItem("oriPosRel"):$("main").find("#gameLogo").parent().removeClass("position-relative");$("main").find("#gameLogo").remove()},4e3)}var n,i,r,u,t;removeSaveLoading();$("#pointsNav, #pointsDropdown").on("mouseenter",function(){clearTimeout(n);$("#pointsNav").addClass("show");$("#pointsNav").attr("aria-expanded","true");$("#pointsDropdown").addClass("show");$("#pointsDropdown").attr("data-bs-popper","none")});$("#pointsNav, #pointsDropdown").on("mouseleave",function(){n=setTimeout(function(){$("#pointsNav").removeClass("show");$("#pointsNav").attr("aria-expanded","false");$("#pointsDropdown").removeClass("show");$("#pointsDropdown").attr("data-bs-popper","")},100)});$("#pointsShop").on("click",function(){strPoints="pointsShop";sessionStorage.setItem("strPoints",strPoints)});$("#pointsHistory").on("click",function(){strPoints="pointsHistory";sessionStorage.setItem("strPoints",strPoints)});$("#coupon").on("click",function(){strPoints="coupon";sessionStorage.setItem("strPoints",strPoints)});i=$("#isLogin").find("span");i.length!=0?($("#OrganizersLoginRegisterNav").hide(),$("#userCollections").show(),sessionStorage.setItem("userLogin","true")):($("#OrganizersLoginRegisterNav").show(),$("#userCollections").hide(),sessionStorage.removeItem("userLogin"));$("#home").on("mousedown",function(){setTimeout(function(){$("#logo").css("animation-name","logoSpin")},1e3);n=setTimeout(function(){var n,t;$("#logo").css("animation-name","");n=new bootstrap.Toast($("#liveToast"));$("#logoed").index()!=-1?(t=$("#logoed").data("uri"),fetch(t,{method:"GET"}).then(n=>n.json()).then(t=>{if(t=="今日已完成小遊戲")$("#liveToast>.toast-header").html(`<strong class="me-auto">今日完成次數達上限!</strong><button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>`),$("#liveToast>.toast-body").text(`今日完成隱藏小遊戲次數已達上限`);else{$("#liveToast>.toast-header").html(`<strong class="me-auto">恭喜找到隱藏小遊戲</strong><button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>`);$("#liveToast>.toast-body").text(`恭喜獲得${t[0]}點
現在點數:${t[1]}
今日已完成隱藏小遊戲次數:(${t[2]}/1)`);var i=`${$("#home").data("uri")}`;fetch(i,{method:"GET"}).then(()=>{sessionStorage.setItem("userPointsEdited","true")}).catch(n=>{alert(n)})}n.show()}).catch(n=>{alert(n)})):($("#liveToast>.toast-header").html(`<strong class="me-auto">什麼都沒有發生</strong><button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>`),$("#liveToast>.toast-body").text(`恭喜找到小彩蛋`),n.show())},3e3)});$("#home").on("mouseup",function(){$("#logo").css("animation-name","");clearTimeout(n)});$("#checkIn").on("click",function(){var n=`${$(this).data("uri")}`;fetch(n,{method:"GET"}).then(n=>n.json()).then(n=>{var i=new bootstrap.Toast($("#liveToast")),t;n=="今日已簽到"?($("#liveToast>.toast-header").html(`<strong class="me-auto">今日已簽到!</strong><button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>`),$("#liveToast>.toast-body").text(`今日已簽到完成`)):($("#liveToast>.toast-header").html(`<strong class="me-auto">每日簽到完成!</strong><button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>`),$("#liveToast>.toast-body").text(`恭喜獲得${n[0]}點
現在點數:${n[1]}`),t=`${$("#home").data("uri")}`,fetch(t,{method:"GET"}).then(()=>{sessionStorage.setItem("userPointsEdited","true")}).catch(n=>{alert(n)}));i.show();$(this).hide()}).catch(n=>{alert(n)})});r=$("#game").data("src");u=$("#game").data("uri");$("#game").index()!=-1&&$(".spinBtn").index()==-1?t=setInterval(function(){f()},4100):clearInterval(t)});